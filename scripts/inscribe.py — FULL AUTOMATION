#!/usr/bin/env python3
# inscribe.py — AGŁG v74: Inscribe on Bitcoin
import subprocess, json, time
from pathlib import Path

def inscribe(file_path, content_type="text/plain", fee_rate=20, satoshi=None):
    cmd = [
        "ord", "wallet", "inscribe",
        "--file", str(file_path),
        "--content-type", content_type,
        "--fee-rate", str(fee_rate)
    ]
    if satoshi:
        cmd += ["--sat", str(satoshi)]
    
    print(f"INSCRIBING: {file_path}")
    result = subprocess.run(cmd, capture_output=True, text=True)
    
    if "inscription" in result.stdout:
        inscription_id = result.stdout.split("inscription ")[1].split()[0]
        print(f"SUCCESS: {inscription_id}")
        return inscription_id
    else:
        print(f"ERROR: {result.stderr}")
        return None

def main():
    # Example: Inscribe Codex 002
    file = Path("codex/002.yaml")
    inscription_id = inscribe(file, "text/yaml", fee_rate=30)
    
    if inscription_id:
        print(f"EXPLORER: https://ordinals.com/inscription/{inscription_id}")
        print("SATOSHI #20 — CODEX 002 INSCRIBED")
    else:
        print("INSCRIPTION FAILED")

if __name__ == "__main__":
    main()